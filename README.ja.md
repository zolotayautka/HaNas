# HaNas

[한국어](./README.ko.md) | **日本語** | [English](./README.md)

Webインターフェースを備えた軽量で自己完結型のファイル管理システムです。ブラウザを通じてファイルをアップロード、整理し、メディアをストリーミングできます。

## 機能

- 📁 **ファイル管理**: フォルダ作成、ファイルアップロード、コピー、移動、名前変更、削除
- 🎵 **メディア再生**: 一般的な形式のオーディオおよびビデオプレーヤーを内蔵
- 🌍 **多言語対応**: 日本語、韓国語、英語の自動検出とサポート
- 📊 **アップロード進捗**: SSEによるリアルタイムアップロード進捗追跡
- 🔄 **ファイル上書き**: 再アップロード時に既存ファイルを自動更新
- 📦 **単一バイナリ**: すべてのアセットが組み込まれ、外部依存関係が不要
- 🎨 **クリーンなUI**: シンプルでレスポンシブなインターフェース

## サポートされているメディア形式

**オーディオ**: MP3, M4A, WAV, OGG, FLAC, AAC  
**ビデオ**: MP4, WebM, OGG, MOV, MKV

## インストール

### 前提条件
- Go 1.16以上

### ソースからビルド

```bash
git clone https://github.com/yourusername/HaNas.git
cd HaNas
go build
```

## 使用方法

1. サーバーを起動:
```bash
./hanas
```

2. ブラウザを開いて以下にアクセス:
```
http://localhost:8080
```

3. ファイルのアップロードと整理を開始しましょう！

## 設定

- **ポート**: デフォルトは `8080` (`main()` 関数で変更)
- **データディレクトリ**: `./data` (ファイル保存場所)
- **データベース**: `./database.db` (SQLiteデータベース)

## APIエンドポイント

### ファイル操作
- `GET /node/:id` - ノード情報と子要素を取得
- `GET /file/:id` - ファイルをダウンロードまたはストリーミング
- `POST /upload` - ファイルアップロードまたはフォルダ作成
- `POST /copy` - ファイル/フォルダをコピー
- `POST /move` - ファイル/フォルダを移動
- `POST /rename` - ファイル/フォルダの名前変更
- `POST /delete` - ファイル/フォルダを削除

### 進捗追跡
- `GET /upload/progress?upload_id=<id>` - アップロード進捗のためのSSEエンドポイント

## プロジェクト構造

```
HaNas/
├── server/         # バックエンドサーバーファイル
│   ├── app.go      # メインバックエンドロジック
│   ├── go.mod      # Goモジュール依存関係
│   ├── index.html  # Webインターフェース
│   ├── index.js    # フロントエンドロジック
│   └── i18n.js     # 国際化
├── client/         # ネイティブクライアントアプリケーション
│   └── HaNas for Mac/  # macOSネイティブクライアント
├── data/           # ファイルストレージ（自動作成）
├── thumbnails/     # サムネイルキャッシュ
├── database.db     # SQLiteデータベース（自動作成）
└── hanas           # コンパイル済みサーバーバイナリ
```

## 技術詳細

### バックエンド
- **言語**: Go
- **データベース**: GORMを使用したSQLite
- **機能**: 
  - Range リクエストサポート付きファイルストリーミング
  - 進捗追跡のためのServer-Sent Events
  - MIMEタイプ検出
  - 階層的フォルダ構造

### フロントエンド
- **バニラJavaScript**: フレームワーク不要
- **機能**:
  - ドラッグアンドドロップサポート（ファイル入力経由）
  - リアルタイムアップロード進捗
  - メディアプレーヤー統合
  - レスポンシブデザイン

## 言語サポート

インターフェースは自動的にブラウザの言語を検出し、以下の言語で表示されます:
- 🇯🇵 日本語 (ja)
- 🇰🇷 韓国語 (ko)
- 🇬🇧 英語 (en - デフォルト)

## 開発

### 新しい言語の追加

1. `i18n.js`を編集して言語コードを追加:
```javascript
const i18n = {
  // ... 既存の言語
  fr: {
    home: 'Accueil',
    // ... すべての翻訳を追加
  }
};
```

2. `index.js`の言語検出を更新:
```javascript
if(userLang.startsWith('ja')) lang = 'ja';
else if(userLang.startsWith('ko')) lang = 'ko';
else if(userLang.startsWith('fr')) lang = 'fr'; // これを追加
else lang = 'en';
```

### サポートされているメディア形式の変更

`index.js`の`isMediaByName()`関数を編集:
```javascript
const audio = ['mp3','m4a','wav','ogg','flac','aac','your-format'];
const video = ['mp4','webm','ogg','mov','mkv','your-format'];
```

## セキュリティに関する考慮事項

⚠️ **これは開発/個人使用ツールです**。本番環境で使用する場合は、以下を検討してください:
- 認証/認可の追加
- レート制限の実装
- HTTPSサポートの追加
- ファイル名のサニタイズ
- ファイルタイプの制限
- ファイルサイズ制限の追加

## ライセンス

MIT License

## コントリビューション

コントリビューションを歓迎します！プルリクエストをお気軽に提出してください。

## トラブルシューティング

**問題**: フォルダと同じ名前のファイルをアップロードできない  
**解決策**: これは競合を防ぐための設計です。まずファイルまたはフォルダの名前を変更してください。

**問題**: メディアファイルが再生されない  
**解決策**: ファイル形式がサポートされているか確認してください。コンテナ形式がリストされていても、ブラウザがすべてのコーデックをサポートしているとは限りません。

**問題**: アップロード進捗が0%で止まる  
**解決策**: ブラウザのコンソールでエラーを確認してください。upload_idパラメータが正しく渡されているか確認してください。

---

Goとバニラ JavaScriptで❤️を込めて制作
